# –î–µ—Ä–µ–≤—å—è, —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö

#### 1\. Splay. –¢—Ä–∏ –≤–∏–¥–∞ –ø–æ–≤–æ—Ä–æ—Ç–æ–≤. –û–ø–µ—Ä–∞—Ü–∏—è Splay, Add.

**Splay-–¥–µ—Ä–µ–≤–æ** - —Å–∞–º–æ–±–∞–ª–∞–Ω—Å–∏—Ä—É—é—â–µ–µ—Å—è BST –¥–µ—Ä–µ–≤–æ, –Ω–µ —Ö—Ä–∞–Ω—è—â–µ–µ –≤ –≤–µ—Ä—à–∏–Ω–µ
–Ω–∏–∫–∞–∫–æ–π –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏. –í —Ö—É–¥—à–µ–º —Å–ª—É—á–∞–µ –≥–ª—É–±–∏–Ω–∞ –¥–µ—Ä–µ–≤–∞
–º–æ–∂–µ—Ç –±—ã—Ç—å –ª–∏–Ω–µ–π–Ω–∞, –Ω–æ –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏–æ–Ω–Ω–æ–µ –≤—Ä–µ–º—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –ø–æ–ª—É—á–∏—Ç—Å—è
–∑–∞ `O(log n)`.

**Splay** - —Å–æ–≤–µ—Ä—à–∞–µ—Ç –ø–æ–≤–æ—Ä–æ—Ç—ã, —Ç–æ –µ—Å—Ç—å —á–µ—Ä–µ–¥—É–µ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ –≤–∏–¥—ã –ø–æ–≤–æ—Ä–æ—Ç–æ–≤.

- Zig.
  
<div align="center">

<img style="width: 900px;" src="img/graph(10).svg">

</div>

–ï—Å–ª–∏ `p` - –∫–æ—Ä–µ–Ω—å –¥–µ—Ä–µ–≤–∞ —Å —Å—ã–Ω–æ–º `x`, —Ç–æ —Å–æ–≤–µ—Ä—à–∞–µ–º –æ–¥–∏–Ω –ø–æ–≤–æ—Ä–æ—Ç –≤–æ–∫—Ä—É–≥
—Ä–µ–±—Ä–∞ `(x, p)` –¥–µ–ª–∞—è `x` –∫–æ—Ä–Ω–µ–º –¥–µ—Ä–µ–≤–∞.

- Zig-zig.

<div align="center">

<img style="width: 900px;" src="img/graph11_.svg">

</div>

–ï—Å–ª–∏ `p` - –Ω–µ –∫–æ—Ä–µ–Ω—å, –∞ `x` –∏ `p` –æ–±–∞ –ª–µ–≤—ã–µ –∏–ª–∏ –æ–±–∞ –ø—Ä–∞–≤–µ –¥–µ—Ç–∏, —Ç–æ
–¥–µ–ª–∞–µ–º –ø–æ–≤–æ—Ä–æ—Ç —Ä–µ–±—Ä–∞ `(p, g)`, –≥–¥–µ `g` –æ—Ç–µ—Ü `p`, –∞ –∑–∞—Ç–µ–º –ø–æ–≤–æ—Ä–æ—Ç
`(x, p)`.

- Zig-zag.

<div align="center">

<img style="width: 900px;" src="img/graph12_.svg">

</div>

–ï—Å–ª–∏ `p` - –Ω–µ –∫–æ—Ä–µ–Ω—å –¥–µ—Ä–µ–≤–∞ –∏ `x` –ª–µ–≤—ã–π —Ä–µ–±–µ–Ω–æ–∫, –∞ `p` - –ø—Ä–∞–≤—ã–π —Ä–µ–±–µ–Ω–æ–∫
`g`, –∏–ª–∏ –Ω–∞–æ–±–æ—Ä–æ—Ç, —Ç–æ –¥–µ–ª–∞–µ–º –ø–æ–≤–æ—Ä–æ—Ç –≤–æ–∫—Ä—É–≥ —Ä–µ–±—Ä–∞ `(x, p)`, –∞ –∑–∞—Ç–µ–º
–ø–æ–≤–æ—Ä–æ—Ç –Ω–æ–≤–æ–≥–æ —Ä–µ–±—Ä–∞ `(x, g)`, –≥–¥–µ `g` - –±—ã–≤—à–∏–π —Ä–æ–¥–∏—Ç–µ–ª—å `p`.

**Add** - –∑–∞–ø—É—Å–∫–∞–º `splay(tree, x)`, –µ—Å–ª–∏ `x` —É–∂–µ –±—ã–ª –≤ –¥–µ—Ä–µ–≤–µ, —Ç–æ –æ–Ω
—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∫–æ—Ä–Ω–µ–º.

–ò–Ω–∞—á–µ, –µ—Å–ª–∏ —Ç–µ–∫—É—â–∏–π –∫–æ—Ä–µ–Ω—å –º–µ–Ω—å—à–µ `x`, —Ç–æ –ø–æ–¥–≤–µ—Å–∏–º –µ–≥–æ –∏ –µ–≥–æ –ª–µ–≤–æ–µ
–ø–æ–¥–¥–µ—Ä–µ–≤–æ, –∫–∞–∫ –ª–µ–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ –¥–ª—è `x`, –∞ –ø—Ä–∞–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ
—Ç–µ–∫—É—â–µ–≥–æ –∫–æ—Ä–Ω—è, –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ `splay`, –∫–∞–∫ –ø—Ä–∞–≤–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ.
–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ, —Ç–æ –µ—Å—Ç—å –Ω–∞–æ–±–æ—Ä–æ—Ç, –¥–ª—è —Å–ª—É—á–∞—è, –∫–æ–≥–¥–∞ —Ç–µ–∫—É—â–∏–π –∫–æ—Ä–µ–Ω—å
–±–æ–ª—å—à–µ `x`.

#### 2\. Splay. –§–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞ –≥–ª–∞–≤–Ω–æ–π —Ç–µ–æ—Ä–µ–º—ã –æ –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã.

–û—Ü–µ–Ω–∏–º –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏–æ–Ω–Ω–æ–µ –≤—Ä–µ–º—è –æ–ø–µ—Ä–∞—Ü–∏–∏ splay, –ø–æ–¥–Ω—è–≤—à–µ–π `v` –≤ `u`:


<img src="https://latex.codecogs.com/svg.latex?\Large&space;\forall v, u \ a_{v \rightarrow u} \leq 3(R_u - R_v) + 1 = 3 \log{\frac{size_u}{size_v}} + 1" title="\Large x=\frac{-b\pm\sqrt{b^2-4ac}}{2a}"/>


`R_k = log(size_k)`, –≥–¥–µ `size_k` - —Ä–∞–∑–º–µ—Ä –ø–æ–¥–¥–µ—Ä–µ–≤–∞.

#### 3\. Rope. –ö–æ—Ä–Ω–µ–≤–∞—è. –ß–µ—Ä–µ–∑ Split/Merge.

**Rope** - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ–±—ã –æ–Ω–∞ —É–º–µ–ª–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å
—Å–ª–µ–¥—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏.

a. insert, erase
b. split, merge, rotate

...

#### 4\. LCA-Offline.

‚Ä¶

#### 5\. Heavy-Light Decomposition. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ, –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∑–∞ `O(n)`.

–î–∞–Ω–æ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ –¥–µ—Ä–µ–≤–æ —Å –≤–µ—Å–∞–º–∏ –≤ –≤–µ—Ä—à–∏–Ω–∞—Ö, –Ω—É–∂–Ω–æ —Å—á–∏—Ç–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é
–Ω–∞ –ø—É—Ç—è—Ö –¥–µ—Ä–µ–≤–∞, –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤–µ—Å–æ–≤ –≤–µ—Ä—à–∏–Ω.

**Heavy-Light –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è** - –ø—É—Ç–∏, –æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç—è–∂–µ–ª—ã–º–∏ —Ä–µ–±—Ä–∞–º–∏.

<div align="center">

<img style="width: 400px;" src="img/graph13_.svg">

</div>

#### 6\. Heavy-Light Decomposition. –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.

```javascript
void buildHLD(int v) {
    size[v] = 1;
    ma = -1;
    
    for (int x : children[v]) {
        buildHLD(x); // —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –≤—ã—á–∏—Å–ª—è–µ–º –¥–µ—Ç–µ–π
        size[v] += size[x];
        if (ma == -1 || size[x] > size[ma]) // –≤—ã–±–∏—Ä–∞–µ–º –ø–µ—Ä–≤–æ–≥–æ —Ä–µ–±–µ–Ω–∫–∞
                                            // –∏–ª–∏ —Ç—è–∂–µ–ª–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ
            ma = x;
    }
    
    path[v] = (ma == -1 ? path_n++ : path[ma]); // –Ω–æ–≤—ã–π –ø—É—Ç—å,
                                // –∏–ª–∏ –ø–æ–º–µ—Ç–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø—É—Ç–∏ –¥–ª—è v
    pos[v] = len[path[v]]++; // –ø–æ–∑–∏—Ü–∏—è v –≤ —Ç–µ–∫—É—â–µ–º –ø—É—Ç–∏
    top[path[v]] = v; // –≤–µ—Ä—Ö–Ω—è—è –≤–µ—Ä—à–∏–Ω–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—É—Ç–∏
}
```

#### 7. Heavy-Light Decomposition. –§—É–Ω–∫—Ü–∏–∏ –Ω–∞ –ø—É—Ç–∏ –∑–∞ O(log^2 n).

–û—Ç –ª—é–±–æ–π –≤–µ—Ä—à–∏–Ω—ã –¥–æ –∫–æ—Ä–Ω—è –Ω–µ –±–æ–ª–µ–µ, —á–µ–º `log n` –ø—Ä—ã–∂–∫–æ–≤. –í–æ–∑—å–º—ë–º `lca(v, u)`,
–ø–æ—Å—Ç—Ä–æ–∏–º –ø—É—Ç—å `v -> lca -> u`. –¢–∞–∫ –∫–∞–∫ –ø—Ä—ã–∂–∫–æ–≤ —É –Ω–∞—Å –Ω–µ –±–æ–ª–µ–µ `log n`, –∞ —Ñ—É–Ω–∫—Ü–∏—è
–Ω–∞ –¥–µ—Ä–µ–≤–µ –æ—Ç—Ä–µ–∑–∫–æ–≤ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∑–∞ `log n`, —Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –Ω–∞ –ø—É—Ç–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è
–∑–∞ `O(log^2 n)`.


#### 8. Heavy-Light Decomposition. –§—É–Ω–∫—Ü–∏–∏ –ø–æ–¥–¥–µ—Ä–µ–≤–∞ –∑–∞ O(log n).

–§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–¥–Ω–æ–π –≤–µ—Ä—à–∏–Ω—ã –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∑–∞ `O(log n)`, —Ç–∞–∫ –∫–∞–∫ –ª–µ–∂–∏—Ç –≤ –æ–¥–Ω–æ–º –î–û.

# –ü–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏—è

#### 9\. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏ —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∑–∞–¥–∞—á –≤ –¥–≤—É–¥–æ–ª—å–Ω–æ–º –∏ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–º –≥—Ä–∞—Ñ–µ: –ø–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏–µ, –ø–æ–∏—Å–∫ –≤–µ—Ä—à–∏–Ω–Ω–æ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–≥–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞, —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ–≥–æ –ø–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏—è.

  - **–ü–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏–µ** - –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø–æ–ø–∞—Ä–Ω–æ –Ω–µ—Å–º–µ–∂–Ω—ã—Ö —Ä–µ–±–µ—Ä.
    <div align="center" style="margin: 0; padding: 0;">
    <img style="width: 450px;" src="img/graph2_.svg">
    </div>
  - **–í–µ—Ä—à–∏–Ω–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ** - –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ç–∞–∫–∏—Ö –≤–µ—Ä—à–∏–Ω C, —á—Ç–æ –¥–ª—è –ª—é–±–æ–≥–æ
    —Ä–µ–±—Ä–∞ –æ–¥–∏–Ω –∏–∑ –∫–æ–Ω—Ü–æ–≤ –ª–µ–∂–∏—Ç –≤ C.
    <div align="center" style="margin: 0; padding: 0;">
    <img style="width: 600px;" src="img/graph3_.svg">
    </div>
  - **–ù–µ–∑–∞–≤–∏—Å–∏–º–æ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ** - –ø–æ–ø–∞—Ä–Ω–æ –Ω–µ—Å–º–µ–∂–Ω—ã–µ –≤–µ—Ä—à–∏–Ω—ã.
    <div align="center" style="margin: 0; padding: 0;">
    <img style="width: 350px;"  src="img/graph4_.svg">
    </div>
  - **–°–æ–≤–µ—Ä—à–µ–Ω–Ω–æ–µ –ø–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏–µ** - –ø–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏–µ, –ø–æ–∫—Ä—ã–≤–∞—é—â–µ–µ –≤—Å–µ
    –≤–µ—Ä—à–∏–Ω—ã –≥—Ä–∞—Ñ–∞.
    <div align="center" style="margin: 0; padding: 0;">
    <img style="width: 450px;"  src="img/graph5_.svg">
    </div>

> –í –¥–≤—É–¥–æ–ª—å–Ω–æ–º –≥—Ä–∞—Ñ–µ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ–µ –ø–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏–µ - –ø–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏–µ,
> –ø–æ–∫—Ä—ã–≤–∞—é—â–µ–µ –≤—Å–µ –≤–µ—Ä—à–∏–Ω—ã –º–µ–Ω—å—à–µ–π –¥–æ–ª–∏.

–í –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–º –≥—Ä–∞—Ñ–µ –∑–∞–¥–∞—á–∏: –≤–µ—Ä—à–∏–Ω–Ω–æ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–≥–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ - **NP-—Ç—Ä—É–¥–Ω—ã**.

–ü–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏–µ –≤ –¥–≤—É–¥–æ–ª—å–Ω–æ–º –≥—Ä–∞—Ñ–µ –∏—â–µ—Ç—Å—è –∑–∞ `O(|M| E)`. –í –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–º –∑–∞
`O(V^3)` - –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º —Å–∂–∞—Ç–∏—è ‚Äú—Å–æ—Ü–≤–µ—Ç–∏–π‚Äù (*–≤–∏–¥–∏–º –Ω–µ—á—ë—Ç–Ω—ã–π —Ü–∏–∫–ª - —Å–æ–∂–º—ë–º
–µ–≥–æ, –Ω–∞–π–¥–µ–º –ø–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏–µ –≤ –Ω–æ–≤–æ–º —Ü–∏–∫–ª–µ, —Ä–∞–∑–æ–∂–º—ë–º —Ü–∏–∫–ª, –ø–µ—Ä–µ—Å—Ç—Ä–æ–∏–º
–ø–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏–µ*), –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–º –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ì–∞–±–æ–≤–∞. –ê–ª–≥–æ—Ä–∏—Ç–º –≠–¥–º–æ–Ω–¥—Å–∞ - `O(E sqrt(V))`

#### 10\. –õ–µ–º–º–∞ –æ –¥–æ–ø–æ–ª–Ω—è—é—â–µ–º –ø—É—Ç–∏.

**–ß–µ—Ä–µ–¥—É—é—â–∏–π—Å—è –ø—É—Ç—å** - –ø—É—Ç—å, –≤ –∫–æ—Ç–æ—Ä–æ–º –∏–¥–µ—Ç —Ä–µ–±—Ä–æ –∏–∑ –ø–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏—è (–Ω–µ
–∏–∑ –ø–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏—è), –∞ –∑–∞—Ç–µ–º —Ä–µ–±—Ä–æ –Ω–µ –∏–∑ –ø–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏—è (–∏–∑
–ø–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏—è).

**–î–ß–ü** (*–¥–æ–ø–æ–ª–Ω—è—é—â–∏–π —á–µ—Ä–µ–¥—É—é—â–∏–π—Å—è –ø—É—Ç—å*) - –ø—É—Ç—å –Ω–∞—á–∏–Ω–∞—é—â–∏–π—Å—è –∏
–∑–∞–∫–∞–Ω—á–∏–≤–∞—é—â–∏–π—Å—è –≤ —Å–≤–æ–±–æ–¥–Ω–æ–π –≤–µ—Ä—à–∏–Ω–µ.

<div align="center" style="margin: 0; padding: 0;">

<img style="width: 450px;"  src="img/graph7_.svg">

</div>

> –ö—Ä–∞—Å–Ω—ã–µ —Ä–µ–±—Ä–∞ - —Ä–µ–±—Ä–∞ –∏–∑ –ø–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏—è, –∞ –∑–µ–ª–µ–Ω—ã–µ - –Ω–µ—Ç. –ò—Ö
> —á–µ—Ä–µ–¥–æ–≤–∞–Ω–∏–µ - –î–ß–ü.

**–°–≤–æ–±–æ–¥–Ω–∞—è –≤–µ—Ä—à–∏–Ω–∞** - –≤–µ—Ä—à–∏–Ω–∞, –Ω–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—â–∞—è –ø–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏—é.

**–õ–µ–º–º–∞**. –ü–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏–µ `M` –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ <=> –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –î–ß–ü.

(**=\>**) –ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —á—Ç–æ –ø–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏–µ `M` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ, –∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
–¥–æ–ø–æ–ª–Ω—è—é—â–∏–π –ø—É—Ç—å `P`. –ü—Ä–æ–π–¥–µ–º—Å—è –ø–æ –Ω–µ–º—É: –≤—Å–µ —Ä–µ–±—Ä–∞ –Ω–µ –∏–∑ –ø–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏—è
–¥–æ–±–∞–≤—è—Ç—Å—è –≤ –ø–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏–µ, –∞ –¥—Ä—É–≥–∏–µ —É–¥–∞–ª—è—Ç—Å—è –∏–∑ –Ω–µ–≥–æ. –¢–æ –µ—Å—Ç—å –º—ã
–ø–æ–ª—É—á–∞–µ–º –ø–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏–µ `M'` –±–æ–ª—å—à–µ–µ `M`, –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–µ.

(**\<=**) –ü—É—Å—Ç—å –µ—Å—Ç—å –¥–≤–∞ –ø–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏—è `M`, `M'` —Ç–∞–∫–∏–µ, —á—Ç–æ `|M'| >
|M|`, —Ç–æ–≥–¥–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –î–ß–ü –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ `M`. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø–æ–¥–≥—Ä–∞—Ñ `H = M
\xor M'`. –ì—Ä–∞—Ñ, –≤ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥—É—Ç —Ç–æ–ª—å–∫–æ —Ä–µ–±—Ä–∞, –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—â–∏–µ —Ç–æ–ª—å–∫–æ
–æ–¥–Ω–æ–º—É –∏–∑ –ø–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏–π. –í —Ç–∞–∫–æ–º –≥—Ä–∞—Ñ–µ —Å—Ç–µ–ø–µ–Ω—å –∫–∞–∂–¥–æ–π –≤–µ—Ä—à–∏–Ω—ã –Ω–µ
–±–æ–ª—å—à–µ –¥–≤—É—Ö, —Ç–∞–∫ –∫–∞–∫ –∫–∞–∂–¥–∞—è –≤–µ—Ä—à–∏–Ω–∞ –º–∞–∫—Å–∏–º—É–º –∏–Ω—Ü–∏–¥–µ–Ω—Ç–Ω–∞ —Ä–µ–±—Ä—É –∏–∑ `M` –∏
`M'`. –í —Ç–∞–∫–æ–º –≥—Ä–∞—Ñ–µ –∫–∞–∂–¥–∞—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ —Å–≤—è–∑–Ω–æ—Å—Ç–∏ - —Ü–∏–∫–ª –∏–ª–∏ –ø—É—Ç—å, –≤
–∫–æ—Ç–æ—Ä—ã—Ö —á–µ—Ä–µ–¥—É—é—Ç—Å—è —Ä–µ–±—Ä–∞ –∏–∑ M –∏ M‚Äô. –¢–∞–∫ –∫–∞–∫ `|M'| > |M|`, —Ç–æ –µ—Å—Ç—å
–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ —Å–≤—è–∑–Ω–æ—Å—Ç–∏, –≤ –∫–æ—Ç–æ—Ä–æ–π —Ä–µ–±–µ—Ä –∏–∑ `M'` –±—É–¥–µ—Ç –±–æ–ª—å—à–µ. –≠—Ç–æ –º–æ–∂–µ—Ç
–±—ã—Ç—å —Ç–æ–ª—å–∫–æ –ø—É—Ç—å, —É –∫–æ—Ç–æ—Ä–æ–≥–æ –æ–±–∞ –∫—Ä–∞–π–Ω–∏—Ö —Ä–µ–±—Ä–∞ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç `M'`. –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ
`M` —ç—Ç–æ—Ç –ø—É—Ç—å –µ—Å—Ç—å –î–ß–ü.

<div align="center" style="margin: 0; padding: 0;">

<img style="width: 550px;"  src="img/graph14_.svg">

</div>

#### 11\. dfs –¥–ª—è –¥–æ–ø–æ–ª–Ω—è—é—â–µ–≥–æ –ø—É—Ç–∏, –ø—Ä–æ—Å—Ç–µ–π—à–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º –∑–∞ O(V(V + E)).

–ü—É—Å—Ç—å `G` - –¥–≤—É–¥–æ–ª—å–Ω—ã–π –≥—Ä–∞—Ñ, –∞ `P` –ø–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏–µ –≤ –Ω–µ–º. –ü–æ—Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ
`G'(G, P)`, –≤ –∫–æ—Ç–æ—Ä–æ–º –≤–µ—Ä—à–∏–Ω—ã —Ç–∞–∫–∏–µ –∂–µ, –∫–∞–∫ –≤ `G`. –†–µ–±—Ä–∞: –∏–∑ –ø–µ—Ä–≤–æ–π –¥–æ–ª–∏
–≤–æ –≤—Ç–æ—Ä—É—é –ø—É—Å—Ç–∏–º –≤—Å–µ —Ä—ë–±—Ä–∞ `G`, –∞ –∏–∑ –≤—Ç–æ—Ä–æ–π –≤ –ø–µ—Ä–≤—É—é —Ä–µ–±—Ä–∞ –∏–∑
–ø–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏—è `P`.

–ü–æ–ª—É—á–∞–µ—Ç—Å—è, —á—Ç–æ –ø–æ–∏—Å–∫ –î–ß–ü - —ç—Ç–æ –ø–æ–∏—Å–∫ –ø—É—Ç–∏ –∏–∑ —Å–≤–æ–±–æ–¥–Ω–æ–π –≤ —Å–≤–æ–±–æ–¥–Ω—É—é
–≤–µ—Ä—à–∏–Ω—É –≤ –≥—Ä–∞—Ñ–µ `G'`.

``` javascript
...

bool dfs(int v) {
    used[v] = true;
    for (int to : graph[v])
        if (pair[to] == -1) or (!used[pair[to]] && dfs(pair[to]))
            pair[to] = v
            return true;
    return false;
}

...

for (int i = 1..n) {
    used[..] = 0;
    dfs(i);
}

...
```

#### 12\. –ê–ª–≥–æ—Ä–∏—Ç–º –ø–æ–∏—Å–∫–∞ VC –∏ IS –∑–∞ O(E).

–û—Ä–∏–µ–Ω—Ç–∏—Ä—É–µ–º —Ä–µ–±—Ä–∞ –ø–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏—è, —á—Ç–æ–±—ã –æ–Ω–∏ —à–ª–∏ –∏–∑ –ø—Ä–∞–≤–æ–π –¥–æ–ª–∏ –≤ –ª–µ–≤—É—é,
—Ä–µ–±—Ä–∞ –Ω–µ –∏–∑ –ø–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏—è ‚Äî —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω–∏ —à–ª–∏ –∏–∑ –ª–µ–≤–æ–π –¥–æ–ª–∏ –≤ –ø—Ä–∞–≤—É—é.
–í –≥—Ä–∞—Ñ–µ `G'` –∑–∞–ø—É—Å—Ç–∏–º `dfs` –∏–∑ —Å–≤–æ–±–æ–¥–Ω—ã—Ö –≤–µ—Ä—à–∏–Ω –ø–µ—Ä–≤–æ–π –¥–æ–ª–∏, –≥–¥–µ
–æ–±–æ–∑–Ω–∞—á–∏–º `A` - –ø–µ—Ä–≤–∞—è –¥–æ–ª—è, `B` - –≤—Ç–æ—Ä–∞—è. –í—Å–µ –ø–æ—Å–µ—â–µ–Ω–Ω—ã–µ `dfs`
–≤–µ—Ä—à–∏–Ω—ã –æ–±–æ–∑–Ω–∞—á–∏–º `A^+`, `B^+`, –∞ –Ω–µ–ø–æ—Å–µ—â—ë–Ω–Ω—ã–µ `A^-`, `B^-`.

`X = A^- \cup B^+` - –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤–µ—Ä—à–∏–Ω–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ.

`Y = A^+ \cup B^-` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ. –ò–∑ `A^+` –≤
`B^-` –Ω–µ—Ç —Ä–µ–±–µ—Ä, –∏–Ω–∞—á–µ –º—ã —Å–º–æ–≥–ª–∏ –ø—Ä–æ–π—Ç–∏ –ø–æ –Ω–∏–º.

<div align="center" style="margin: 0; padding: 0;">

<img style="width: 300px;"  src="img/graph8_.svg">

</div>

#### 13\. –†–∞–∑–±–∏–µ–Ω–∏–µ –≤–µ—Ä—à–∏–Ω –æ—Ä–≥—Ä–∞—Ñ–∞ –Ω–∞ —Ü–∏–∫–ª—ã. –†–∞–∑–±–∏–µ–Ω–∏–µ –≤–µ—Ä—à–∏–Ω –∞—Ü–∏–∫–ª–∏—á–Ω–æ–≥–æ –æ—Ä–≥—Ä–∞—Ñ–∞ –Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –ø—É—Ç–µ–π.

**–î–∞–Ω –∞—Ü–∏–∫–ª–∏—á–Ω—ã–π –æ—Ä–≥—Ä–∞—Ñ (DAG). –†–∞–∑–±–∏—Ç—å –≤—Å–µ –µ–≥–æ –≤–µ—Ä—à–∏–Ω—ã –Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ
—á–∏—Å–ª–æ –ø—É—Ç–µ–π.**

–í–æ–∑—å–º—ë–º –¥–≤—É–¥–æ–ª—å–Ω—ã–π –≥—Ä–∞—Ñ –ø–æ ùëõ –≤–µ—Ä—à–∏–Ω –≤ –∫–∞–∂–¥–æ–π –¥–æ–ª–∏. –ü—Ä–æ–≤–µ–¥—ë–º —Ä–µ–±—Ä–æ ùëñ ‚Üí ùëó
–∏—Å—Ö–æ–¥–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∞ –∏–∑ ùëñ-–π –≤–µ—Ä—à–∏–Ω—ã –ø–µ—Ä–≤–æ–π –¥–æ–ª–∏ –≤ ùëó-—É—é –≤–µ—Ä—à–∏–Ω—É –≤—Ç–æ—Ä–æ–π –¥–æ–ª–∏.
–¢–∞–∫–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è ¬´—Ä–∞–∑–¥–≤–æ–µ–Ω–∏–µ –æ—Ä–≥—Ä–∞—Ñ–∞¬ª. –í —Ä–∞–∑–¥–≤–æ–µ–Ω–Ω–æ–º –≥—Ä–∞—Ñ–µ
–≤–æ–∑—å–º—ë–º —Ä—ë–±—Ä–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏—è, –Ω–∞—Ä–∏—Å—É–µ–º –∏—Ö –≤ –∏—Å—Ö–æ–¥–Ω–æ–º,
–ø–æ–ª—É—á–∏–ª–∏ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –ø—É—Ç–µ–π.

...

#### 14\. Stable matching (marriage problem). –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏. –†–µ—à–µ–Ω–∏–µ. –ü—Ä–∏–º–µ—Ä –ø—Ä–æ –ï–ì–≠.

–°—Ñ–æ—Ä–º—É–ª–∏—Ä—É–µ–º –∑–∞–¥–∞—á—É –Ω–∞ —è–∑—ã–∫–µ –º–∞–ª—å—á–∏–∫–æ–≤/–¥–µ–≤–æ—á–µ–∫. –ï—Å—Ç—å `n` –º–∞–ª—å—á–∏–∫–æ–≤, —É
–∫–∞–∂–¥–æ–≥–æ –∏–∑ –Ω–∏—Ö –µ—Å—Ç—å —Å–ø–∏—Å–æ–∫ –¥–µ–≤–æ—á–µ–∫ `bs[a]`, –∫–æ—Ç–æ—Ä—ã–µ –µ–º—É –Ω—Ä–∞–≤—è—Ç—Å—è –≤
–ø–æ—Ä—è–¥–∫–µ –Ω–∞–∏–±–æ–ª–µ–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã—Ö –∫ –º–µ–Ω–µ–µ. –ï—Å—Ç—å `m` –¥–µ–≤–æ—á–µ–∫, —É –∫–æ—Ç–æ—Ä—ã—Ö
–µ—Å—Ç—å —Ç–∞–∫–æ–π –∂–µ —Å–ø–∏—Å–æ–∫, –æ—Ç–Ω–æ—Å—è—â–∏–π—Å—è –∫ –º–∞–ª—å—á–∏–∫–∞–º, `as[b]`. `!` –ú–∞–ª—å—á–∏–∫–∏
–∏ –¥–µ–≤–æ—á–∫–∏ —Ö–æ—Ç—è—Ç –æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –ø–∞—Ä—ã.

–ù–∏–∫—Ç–æ –Ω–µ –≥–æ—Ç–æ–≤ –æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å –ø–∞—Ä—É —Å —Ç–µ–º, –∫—Ç–æ –≤–æ–æ–±—â–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ –µ–≥–æ
—Å–ø–∏—Å–∫–µ. –ò –¥–ª—è –º–∞–ª—å—á–∏–∫–æ–≤, –∏ –¥–ª—è –¥–µ–≤–æ—á–µ–∫ –Ω–∞–∏–º–µ–Ω–µ–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç - –æ—Å—Ç–∞—Ç—å—Å—è –±–µ–∑ –ø–∞—Ä—ã.

> –û–±–æ–∑–Ω–∞—á–∏–º `p_a` - –ø–∞—Ä–∞ –¥–ª—è –º–∞–ª—å—á–∏–∫–∞ `a` –∏–ª–∏ `-1`, `q_b` - –ø–∞—Ä–∞ –¥–ª—è
> –¥–µ–≤–æ—á–∫–∏ `q` –∏–ª–∏ `-1`.

–ü–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏–µ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è `–Ω–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–º`, –µ—Å—Ç—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –º–∞–ª—å—á–∏–∫ `a` –∏
–¥–µ–≤–æ—á–∫–∞ `b`: –º–∞–ª—å—á–∏–∫—É `a` –Ω—Ä–∞–≤–∏—Ç—Å—è `b` –±–æ–ª—å—à–µ —á–µ–º `p_a` –∏ –¥–µ–≤–æ—á–∫–µ `b`
–Ω—Ä–∞–≤–∏—Ç—Å—è `a` –±–æ–ª—å—à–µ —á–µ–º `q_b`.

–ò–Ω–∞—á–µ –ø–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏–µ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è `—Å—Ç–∞–±–∏–ª—å–Ω—ã–º`.

**–†–µ—à–µ–Ω–∏–µ:** –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ –ø—Ä–æ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º `p_a = bs[a].best`, –¥–∞–ª–µ–µ,
–ø–æ–∫–∞ –µ—Å—Ç—å `i != j` –∏ –¥–µ–≤–æ—á–∫–∞ `b = p_i = p_j != -1`. –î–µ–≤–æ—á–∫–∞ `b`
–æ—Ç–∫–∞–∂–µ—Ç —Ç–æ–º—É –∏–∑ –Ω–∏—Ö, –∫—Ç–æ –µ–π –º–µ–Ω—å—à–µ –Ω—Ä–∞–≤–∏—Ç—Å—è. –ü—É—Å—Ç—å –æ–Ω–∞ –æ—Ç–∫–∞–∑–∞–ª–∞
–º–∞–ª—å—á–∏–∫—É `i`, —Ç–æ–≥–¥–∞ –¥–µ–ª–∞–µ–º `bs[i].remove_best()`, `p_i =
bs[i].best`.

**–ü—Ä–∏–º–µ—Ä:** –°—Ç—É–¥–µ–Ω—Ç—ã —Ö–æ—Ç—è—Ç –ø–æ—Å—Ç—É–ø–∏—Ç—å –≤ –í–£–ó—ã. –£ –∫–∞–∂–¥–æ–≥–æ –í–£–ó–∞ –µ—Å—Ç—å
–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç –∏ –º–æ–≥—É—Ç –±—ã—Ç—å —Ä–∞–∑–Ω—ã–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã,
–∫–æ–≥–æ —Ö–æ—Ç—è—Ç –±—Ä–∞—Ç—å. –°—Ç—Ä–æ–∏–º –¥–≤—É–¥–æ–ª—å–Ω—ã–π –≥—Ä–∞—Ñ, –∫–∞–∂–¥—ã–π —Å—Ç—É–¥–µ–Ω—Ç —É–∫–∞–∑—ã–≤–∞–µ—Ç
—Å–ø–∏—Å–æ–∫ –í–£–ó–æ–≤ –≤ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ—Å—Ç–∏. –ö–∞–∂–¥–æ–µ –º–µ—Å—Ç–æ-–≤-–≤—É–∑–µ –ø–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫
—Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –≤ –ø–æ—Ä—è–¥–∫–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ –¥–∞–Ω–Ω–æ–≥–æ –í–£–ó–∞. –ò—â–µ–º —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ
–ø–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏–µ, –ø–æ–ª—É—á–∞–µ–º —Ä–µ—à–µ–Ω–∏–µ, –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤.

# –ü–æ—Ç–æ–∫–∏

#### 15\. Def: –ø–æ—Ç–æ–∫, —Ä–∞–∑—Ä–µ–∑, –≤–µ–ª–∏—á–∏–Ω–∞ –ø–æ—Ç–æ–∫–∞, –≤–µ–ª–∏—á–∏–Ω–∞ —Ä–∞–∑—Ä–µ–∑–∞, —Å–æ—Ç–∞—Ç–æ—á–Ω–∞—è —Å–µ—Ç—å, —Ü–∏—Ä–∫—É–ª—è—Ü–∏—è, –ø—Ä—è–º—ã–µ –∏ –æ–±—Ä–∞—Ç–Ω—ã–µ —Ä–µ–±—Ä–∞, –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è –ø–æ—Ç–æ–∫–∞.

**–ü–æ—Ç–æ–∫ –≤ –æ—Ä–≥—Ä–∞—Ñ–µ** –∏–∑ s –≤ t - —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ —Ä–µ–±—Ä–∞–º —á–∏—Å–ª–∞ `f_e \in
\mathbb{R}`.

<img src="https://latex.codecogs.com/svg.latex?(\forall e \in E : 0 \leq f_e \leq c_e) \wedge (\forall v \neq s, t \sum_{e \in in(v)} f_e = \sum_{e \in out(v)} f_e)" title="\Large x=\frac{-b\pm\sqrt{b^2-4ac}}{2a}"/>

**–†–∞–∑—Ä–µ–∑** - –¥–∏–∑—ä—é–Ω–∫—Ç–Ω–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –≤–µ—Ä—à–∏–Ω (S, T): `v = S \cup T. s \in S, t \in T`.

**–í–µ–ª–∏—á–∏–Ω–∞ –ø–æ—Ç–æ–∫–∞** `|f|` = `\sum_{e \in out(s)} f_e` - `\sum_{e \in
in(s)} f_e`

**–í–µ–ª–∏—á–∏–Ω–∞ —Ä–∞–∑—Ä–µ–∑–∞** - –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å—É–º–º–∞ –ø—Ä–æ–ø—É—Å–∫–Ω—ã—Ö —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π —Ç–∞–∫–∏—Ö
—Ä—ë–±–µ—Ä (i, j) —á—Ç–æ `i \in S , j \in T`.

**–¶–∏—Ä–∫—É–ª—è—Ü–∏—è** - –ø–æ—Ç–æ–∫ –≤–µ–ª–∏—á–∏–Ω—ã –Ω—É–ª—å.

**–ü—Ä—è–º—ã–µ –∏ –æ–±—Ä–∞—Ç–Ω—ã–µ —Ä–µ–±—Ä–∞** - –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–±—Ä–∞ —Å–µ—Ç–∏ `G` —Å –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π
—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å—é `c_e` —Å–æ–∑–¥–∞–¥–∏–º –æ–±—Ä–∞—Ç–Ω–æ–µ —Ä–µ–±—Ä–æ `e'` –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π
—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å—é 0. –ü—Ä–∏ —ç—Ç–æ–º –ø–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é `f_e'` = `-f_e`.

**–î–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è –ø–æ—Ç–æ–∫–∞ f** - –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ `f` –≤ –≤–∏–¥–µ —Å—É–º–º—ã —ç–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω—ã—Ö
–ø–æ—Ç–æ–∫–æ–≤ (–ø—É—Ç–µ–π) –∏ —Ü–∏—Ä–∫—É–ª—è—Ü–∏–∏.

**–û—Å—Ç–∞—Ç–æ—á–Ω–∞—è —Å–µ—Ç—å –ø–æ—Ç–æ–∫–∞ f** - `G_f`, –≥—Ä–∞—Ñ —Å –ø—Ä–æ–ø—É—Å–∫–Ω—ã–º–∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—è–º–∏
c\_e - f\_e.

#### 16\. –ê–ª–≥–æ—Ä–∏—Ç–º –§–æ—Ä–¥–∞-–§–∞–ª–∫–µ—Ä—Å–æ–Ω–∞. –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã. –ë–µ–∑ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞.

**–¢–µ–æ—Ä–µ–º–∞**. –§–æ—Ä–¥–∞-–§–∞–ª–∫–µ—Ä—Å–æ–Ω–∞. 
1. `|f|` = max <=> –Ω–µ—Ç –¥–æ–ø–æ–ª–Ω—è—é—â–µ–≥–æ –ø—É—Ç–∏. 
2. `max |f|` = `min C(S, T)` (–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ç–æ–∫ —Ä–∞–≤–µ–Ω
–º–∏–Ω–∏–º–∞–ª—å–Ω–æ–º—É —Ä–∞–∑—Ä–µ–∑—É)

–ò–∑ —Ç–µ–æ—Ä–µ–º—ã —Å–ª–µ–¥—É–µ—Ç –ø—Ä–æ—Å—Ç–µ–π—à–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º –ø–æ–∏—Å–∫–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞: –ø–æ–∫–∞
–µ—Å—Ç—å –¥–æ–ø–æ–ª–Ω—è—é—â–∏–π –ø—É—Ç—å p, –Ω–∞–π–¥–µ–º –µ–≥–æ, —Ç–æ–ª–∫–Ω–µ–º –ø–æ –Ω–µ–º—É `x = min (c_e -
f_e)`, –≥–¥–µ `e \in p`, –µ–¥–∏–Ω–∏—Ü –ø–æ—Ç–æ–∫–∞.

–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞ `O(|f| E)`.

``` javascript
int dfs(int v, int go) {
    used[v] = 1;
    if (v == t) return go;

    for (int edge : vertexes[v]) {
        Edge& e = edges[edge];
        if (e.f < e.c && !used[e.b]) {
            int push = dfs(e.b, min(e.c - e.f, go));
            if (push) {
                e.f += push;
                edges[e.rev].f -= push;
                return push;
            }
        }
    }
    return 0;
}
```

#### 17\. –ü–æ–∏—Å–∫ min —Ä–∞–∑—Ä–µ–∑–∞ –ø–æ max —Ç–æ–∫—É –∑–∞ `O(E)`.

–ü—É—Å—Ç—å –Ω–µ—Ç –¥–æ–ø–æ–ª–Ω—è—é—â–µ–≥–æ –ø—É—Ç–∏ => `dfs` –∏–∑ `s` –ø–æ –Ω–µ–Ω–∞—Å—ã—â–µ–Ω–Ω—ã–º —Ä–µ–±—Ä–∞–º –Ω–µ
–ø–æ—Å–µ—Ç–∏—Ç `t`. –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –ø–æ—Å–µ—â–µ–Ω–Ω—ã—Ö –≤–µ—Ä—à–∏–Ω –æ–±–æ–∑–Ω–∞—á–∏–º `S`, –æ–±–æ–∑–Ω–∞—á–∏–º `T =
V \ S`. –ò–∑ `S` –≤ `T` –≤–µ–¥—É—Ç —Ç–æ–ª—å–∫–æ `e`: `f_e = c_e`. –≠—Ç–æ –∂–µ –µ—Å—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º
min —Ä–∞–∑—Ä–µ–∑–∞ –ø–æ max –ø–æ—Ç–æ–∫—É –∑–∞ `O(E)`.

#### 18\. –î–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è –ø–æ—Ç–æ–∫–∞ –Ω–∞ –ø—É—Ç–∏ –∑–∞ `O(E^2)`. –¶–∏—Ä–∫—É–ª—è—Ü–∏—è.

–ü–æ–∫–∞ `|f| > 0` –Ω–∞–π–¥–µ–º –ø—É—Ç—å `p` –∏–∑ `s` –≤ `t` –ø–æ —Ä–µ–±—Ä–∞–º `e`: `f_e > 0`. –ü–æ
–≤—Å–µ–º —Ä–µ–±—Ä–∞–º –ø—É—Ç–∏ —É–º–µ–Ω—å—à–∏–º –ø–æ—Ç–æ–∫ –Ω–∞ `min f_e`, `e \in p`.

`O(E^2)` –ø–æ—Å–ª–µ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –ø—É—Ç–∏ –∏ —É–º–µ–Ω—å—à–µ–Ω–∏—è –ø–æ—Ç–æ–∫–∞, –∫–∞–∫ –º–∏–Ω–∏–º—É–º —É –æ–¥–Ω–æ–≥–æ
—Ä–µ–±—Ä–∞ `f_e` –æ–±–Ω—É–ª–∏—Ç—Å—è => –Ω–µ –±–æ–ª–µ–µ `E` –ø–æ–∏—Å–∫–æ–≤ –ø—É—Ç–∏.

#### 19\. –†–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –ø—Ä–æ `k` –Ω–µ–ø–µ—Ä–µ—Å–µ–∫–∞—é—â–∏—Ö—Å—è –ø–æ —Ä–µ–±—Ä–∞–º/–≤–µ—Ä—à–∏–Ω–∞–º –ø—É—Ç–µ–π.

**–ü–æ–∏—Å–∫ —Ä–µ–±–µ—Ä–Ω–æ –Ω–µ–ø–µ—Ä–µ—Å–µ–∫–∞—é—â–∏—Ö—Å—è –ø—É—Ç–µ–π** *–û—Ä–≥—Ä–∞—Ñ:* –∫–∞–∂–¥–æ–º—É
–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É —Ä–µ–±—Ä—É –∑–∞–¥–∞–¥–∏–º –ø—Ä–æ–ø—É—Å–∫–Ω—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å `1`,
–Ω–∞–π–¥–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ç–æ–∫. `|f|` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–±–µ—Ä–Ω–æ –Ω–µ–ø–µ—Ä–µ—Å–µ–∫–∞—é—â–∏—Ö—Å—è
–ø—É—Ç–µ–π.

*–ù–µ–æ—Ä–≥—Ä–∞—Ñ:* –ø—Ä–∏–≤–æ–¥–∏–º –∫ –æ—Ä–≥—Ä–∞—Ñ—É, –¥–µ–ª–∞–µ–º —Ç–æ –∂–µ —Å–∞–º–æ–µ. –ì–¥–µ –æ–±—Ä–∞—Ç–Ω—ã–µ —Ä–µ–±—Ä–∞ –∏–º–µ—é—Ç —Ç–∞–∫—É—é –∂–µ –ø—Ä–æ–ø—É—Å–∫–Ω—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å, –∫–∞–∫ –∏ –ø—Ä—è–º—ã–µ.

**–ü–æ–∏—Å–∫ –≤–µ—Ä—à–∏–Ω–Ω–æ –Ω–µ–ø–µ—Ä–µ—Å–µ–∫–∞—é—â–∏—Ö—Å—è –ø—É—Ç–µ–π** *–û—Ä–≥—Ä–∞—Ñ:* —Ä–∞–∑–¥–≤–∞–∏–≤–∞–µ–º –≤–µ—Ä—à–∏–Ω—É,
–ø–æ—Å–µ—Ä–µ–¥–∏–Ω–µ —Ä–µ–±—Ä–æ —Å –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å—é 1, –≤—Ö–æ–¥—è—â–∏–µ —Ä–µ–±—Ä–∞ –≤ –ø–µ—Ä–≤—É—é
–ø–æ–ª–æ–≤–∏–Ω—É, –∏—Å—Ö–æ–¥—è—â–∏–µ –∏–∑ –≤—Ç–æ—Ä–æ–π. –í–µ—Ä—à–∏–Ω—É –ø–æ—Å–µ—â–∞–µ–º —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑, —Ç–∞–∫ –∫–∞–∫
–ø—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Ä–∞–≤–Ω–∞ 1.

<div align="center" style="margin: 0; padding: 0;">

<img style="width: 500px;"  src="img/graph15_.svg">

</div>

*–ù–µ–æ—Ä–≥—Ä–∞—Ñ:* –ø—Ä–∏–≤–æ–¥–∏–º –∫ –æ—Ä–≥—Ä–∞—Ñ—É, –¥–µ–ª–∞–µ–º —Ç–æ –∂–µ —Å–∞–º–æ–µ.

#### 20\. –ü–æ–∏—Å–∫ –ø–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏—è —á–µ—Ä–µ–∑ –ø–æ—Ç–æ–∫ –∑–∞ `O(VE)`.

–ß—Ç–æ–±—ã —Å –ø–æ–º–æ—â—å—é –ø–æ—Ç–æ–∫ –∏—Å–∫–∞—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –ø–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏–µ –¥–æ–±–∞–≤–∏–º –∏—Å—Ç–æ–∫ –∏
—Å—Ç–æ–∫. –ò–∑ —Å—Ç–æ–∫–∞ –Ω–∞–ø—Ä–∞–≤–∏–º —Ä–µ–±—Ä–∞ –≤ –ø–µ—Ä–≤—É—é –¥–æ–ª—é —Å –ø—Ä–æ–ø—É—Å–∫–Ω—ã–º–∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—è–º–∏ - `1`. –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –∏–∑ –≤—Ç–æ—Ä–æ–π –¥–æ–ª–∏ –≤ —Å—Ç–æ–∫. –ï—Å–ª–∏ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –¥–≤—É–¥–æ–ª—å–Ω—ã–π –≥—Ä–∞—Ñ
–±—ã–ª –Ω–µ–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º, —Ç–æ –Ω–∞–ø—Ä–∞–≤–∏–º —Ä–µ–±—Ä–∞ –∏–∑ –ø–µ—Ä–≤–æ–π –≤–æ –≤—Ç–æ—Ä—É—é –¥–æ–ª—é.
–ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —ç—Ç–∏—Ö —Ä–µ–±–µ—Ä –º–æ–∂–µ—Ç –±—ã—Ç—å –ª—é–±–æ–π, —Ç–∞–∫ –∫–∞–∫ –∏–∑
–≤–µ—Ä—à–∏–Ω—ã –Ω–µ –≤—Ç–æ—Ä–æ–π –¥–æ–ª–∏ –≤ —Å—Ç–æ–∫ –Ω–µ –º–æ–∂–µ—Ç –ø–æ–π—Ç–∏ –ø–æ—Ç–æ–∫ –±–æ–ª—å—à–µ `1`.
–ó–∞–ø—É—Å—Ç–∏–º –∞–ª–≥–æ—Ä–∏—Ç–º –§–æ—Ä–¥–∞-–§–∞–ª–∫–µ—Ä—Å–æ–Ω–∞ –∑–∞ `O(|f| * E) = O(|M| * E) <=
O(VE)`.

#### 21\. –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Ä–∞–∑—Ä–µ–∑: –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ, –±–∞–∑–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ –Ω–∞ `O(V * flow)`.

**–ì–ª–æ–±–∞–ª—å–Ω—ã–π —Ä–∞–∑—Ä–µ–∑** —Ä–∞–≤–µ–Ω –º–∏–Ω–∏–º—É–º—É —Å—Ä–µ–¥–∏ —Ä–∞–∑—Ä–µ–∑–æ–≤ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π
—Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø–æ –≤—Å–µ–≤–æ–∑–º–æ–∂–Ω—ã–º –ø–∞—Ä–∞–º –∏—Å—Ç–æ–∫-—Å—Ç–æ–∫.

–ü—Ä–æ—Å—Ç–µ–π—à–µ–µ —Ä–µ—à–µ–Ω–∏–µ: –ø–µ—Ä–µ–±–µ—Ä–µ–º `s`, `t` –∏ –Ω–∞–π–¥–µ–º —Ä–∞–∑—Ä–µ–∑ –º–µ–∂–¥—É –Ω–∏–º–∏ –∑–∞
`O(V * flow)`.

#### 22\. –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∞—è –∑–∞–¥–∞—á–∞. –§–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞. –†–µ—à–µ–Ω–∏–µ.

–í –≥–æ—Ä–æ–¥–µ –µ—Å—Ç—å –¥–æ—Ä–æ–≥–∏, –∑–∞–≤–æ–¥—ã –∏ –º–∞–≥–∞–∑–∏–Ω—ã. –î–æ—Ä–æ–≥–∏ –æ–±—Ä–∞–∑—É—é—Ç –æ—Ä–≥—Ä–∞—Ñ, —É
–∫–∞–∂–¥–æ–π –¥–æ—Ä–æ–≥–∏ –µ—Å—Ç—å –¥–ª–∏–Ω–∞ `w_i` –∏ –ø—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å `u_i`.
–ö–∞–∂–¥—ã–π –¥–µ–Ω—å `i`-–π –∑–∞–≤–æ–¥ –≤—ã–ø—É—Å–∫–∞–µ—Ç `A_i` –µ–¥–∏–Ω–∏—Ü —Ç–æ–≤–∞—Ä–∞, –∞ `j`-–π
–º–∞–≥–∞–∑–∏–Ω –ø—Ä–æ–¥–∞–µ—Ç `B_j` –µ–¥–∏–Ω–∏—Ü. –ù—É–∂–Ω–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –ø–ª–∞–Ω –¥–æ—Å—Ç–∞–≤–∫–∏, —á—Ç–æ–±—ã
`\sum f_i \cdot w_i` –±—ã–ª–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–∞.

**–†–µ—à–µ–Ω–∏–µ:**
–î–æ–±–∞–≤–ª—è–µ–º –∏—Å—Ç–æ–∫, –∏–∑ –Ω–µ–≥–æ –≤–µ—Ä—à–∏–Ω—ã —Å –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å—é `A_i`.
–î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–æ–∫, –∏–∑ –≤—Ç–æ—Ä–æ–π –¥–æ–ª–∏ - –º–∞–≥–∞–∑–∏–Ω–æ–≤, –ø—Ä–æ–≤–µ–¥–µ–º —Ä–µ–±—Ä–∞ —Å –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å—é
`B_i`. –ù–∞–π–¥–µ–º mincost max flow.

–ï—Å–ª–∏ `c_e = inf`, —Ç–æ —Å—Ç—Ä–æ–∏–º –º–∞—Ç—Ä–∏—Ü—É —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π, –¥–≤—É–¥–æ–ª—å–Ω—ã–π –≥—Ä–∞—Ñ. –ò—â–µ–º
mincost flow –∏–ª–∏ –≤–µ–Ω–≥–µ—Ä–∫–∞.

#### 23\. –ó–∞–¥–∞—á–∏ mincost k-flow, mincost max flow, mincost circulation. –°–≤–µ–¥–µ–Ω–∏—è –¥—Ä—É–≥ –∫ –¥—Ä—É–≥—É.

**Mincost k-flow** - –ø–æ–∏—Å–∫ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–æ –≤–µ—Å—É –ø–æ—Ç–æ–∫–∞ –≤–µ–ª–∏—á–∏–Ω–æ–π `k`.

**Mincost max flow** - –ø–æ–∏—Å–∫ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –∑–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å.

**Mincost circulation** - –Ω–∞–π—Ç–∏ –ø–æ—Ç–æ–∫ –Ω—É–ª–µ–≤–æ–π –≤–µ–ª–∏—á–∏–Ω—ã —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç—å—é.

...

#### 24. –ê–ª–≥–æ—Ä–∏—Ç–º –ø–æ–∏—Å–∫–∞ mincost k-flow –≤ –≥—Ä–∞—Ñ–µ –±–µ–∑ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–∏–∫–ª–æ–≤ –∑–∞ `O(k * FordBellman)`.

–ó–∞–ø—É—Å–∫–∞–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º –§–æ—Ä–¥–∞-–ë–µ–ª–ª–º–∞–Ω–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏—Å–∫–∞—Ç—å –ø–æ—Ç–æ–∫ –∏–∑ `s` –≤ `t` 
—Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º –≤–µ—Å–æ–º –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –æ–Ω –Ω–µ —Å—Ç–∞–Ω–µ—Ç `k`.

```javascript

bool fordBellaman() {
    dist[..] = INF;
    used[..] = 0;
    
    dist[s] = 0;
    used[s] = 1;
    
    fl = INF;
    
    queue.push(s);
    while (!queue.empty()) {
        int v = queue.pop();
        for (int to : graph[v]) {
            Edge & e = edges[to];
            if (e.f < e.c && dist[e.to] > dist[v] + e.w) {
                dist[e.to] = dist[v] + e.w;
                fl = min(fl, e.c - e.f);
                path[e.to] = to; 
                
                if (!used[e.to]) 
                    queue.push(e.to)
                    used[e.to] = 1;
            }
        }
    }
    
    if (dist[t] == INF) return false;
    
    FLOW += fl;
    MINCOST += dist[t] * fl;
    for (int v = t; v != s; v = edges[path[v]].from) {
        edges[path[v]].f += fl;
        edges[path[v] ^ 1].f -= fl;
    }
    
    return true;
}


while (FLOW < k && fordBellaman()) {}

```

#### 25. Flow. –ü–æ–∏—Å–∫ –ø–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏—è min/max –≤–µ—Å–∞ —á–µ—Ä–µ–∑ mincost –ø–æ—Ç–æ–∫–∏.

–°—Ç—Ä–æ–∏–º —Å—Ç–æ–∫ –∏ –∏—Å—Ç–æ–∫ —Å–æ 0 –≤–µ—Å–æ–º, –∏ `w_{ij}` –º–µ–∂–¥—É –¥–æ–ª—è–º–∏, –∏—â–µ–º mincost –ø–æ—Ç–æ–∫.

–î–ª—è –ø–æ–∏—Å–∫–∞ max –ø–æ –º–µ–∂—É –ø–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏—è: —Å—Ç—Ä–æ–∏–º —Ç–æ –∂–µ —Å–∞–º–æ–µ, –Ω–æ –º–µ–∂–¥—É –¥–æ–ª—è–º–∏ –≤–µ—Å `-w_{ij}`.
–ò—â–µ–º minscost –ø–æ—Ç–æ–∫.

–ë–∏–µ–∫—Ü–∏—è —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤–µ—Å–∞ –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏ –∏ –ø–∞—Ä–æ—Å–æ—á–µ—Ç–∞–Ω–∏—è–º–∏. –†–∞–±–æ—Ç–∞ —Å –î–µ–π–∫—Å—Ç—Ä–æ–π `VE + flow * V^2 = O(V^3)`.

#### 26. Flow. –ì—Ä–∞—Ñ—ã —Å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º–∏ —Ü–∏–∫–ª–∞–º–∏. –ê–ª–≥–æ—Ä–∏—Ç–º –ö–ª–µ–π–Ω–∞.

...


# –°—Ç—Ä–æ–∫–∏

#### 27\. –ö–ú–ü –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ–¥—Å—Ç—Ä–æ–∫–∏.

`\pi_0 (s)` - –¥–ª–∏–Ω–∞ max —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø—Ä–µ—Ñ–∏–∫—Å–∞ `s`, —Å–æ–≤–ø–∞–¥–∞—é—â–µ–≥–æ —Å
—Å—É—Ñ—Ñ–∏–∫—Å–æ–º `s`.

**–ü—Ä–µ—Ñ–∏–∫—Å-—Ñ—É–Ω–∫—Ü–∏—è** —Å—Ç—Ä–æ–∫–∏ `s` - –º–∞—Å—Å–∏–≤ `\pi (s)`: `\pi (s) [i]` =
`\pi_0 (s[0:i))`
#### 29. –ü–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã–π —Ö–µ—à, —Ö–µ—à –ø–æ–¥—Å—Ç—Ä–æ–∫–∏.

–ü–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã–π —Ö–µ—à: <img src="https://latex.codecogs.com/svg.latex?hash_{p, m} (s) = ( s_0 p^{n - 1} + s_1 p^{n - 2} + \dots + s_{n - 1})  \ mod \ m" title="\Large x=\frac{-b\pm\sqrt{b^2-4ac}}{2a}"/>

–î–ª–∏–Ω–∞ —Å—Ç—Ä–æ–∫–∏ `|s| = n`, `p` - —Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ, `m` - –ø—Ä–æ—Å—Ç–æ–µ —á–∏—Å–ª–æ.

–ü—Ä–µ–¥–ø–æ–¥—Å—á–µ—Ç —Å—Ç–µ–ø–µ–Ω–µ–π `p` –º–æ–∂–µ–º —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –º–∞—Å—Å–∏–≤ `deg`, —Ç–æ –µ—Å—Ç—å –≤ `deg[i] = p^i`. 
–≠—Ç–æ –Ω–∞–º –ø–æ–º–æ–∂–µ—Ç —Å—á–∏—Ç–∞—Ç—å —Ö–µ—à —Å –æ—Ç—Ä–µ–∑–∫–∞, –¥–ª—è –≤–∑—è—Ç–∏—è —Ö–µ—à–∞ –∏—Å—Ö–æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ö–µ–º—É –ì–æ—Ä–Ω–µ—Ä–∞.

```javascript
int* h;
void hashFunction(int n, char* s) {
    h = new int[n + 1];
    h[0] = 0;
    for (int i = 0; i < n; ++i)
        h[i + 1] = ((int64_t)h[i] * p + s[i]) % m;
}

int getHash(int l, int r, char* s) {
    T res = (h[r] - (int64_t)h[l] * deg[r - l]) % m;
    return res < 0 ? res + m : res;
}
```

–ù–∞–ø—Ä–∏–º–µ—Ä, –≤–æ–∑—å–º—ë–º —Ö–µ—à –æ—Ç —Å—Ç—Ä–æ–∫–∏ "abcd":

`hash(abcd) = a * p^3 + b * p^2 + c * p + d`

–í–æ–∑—å–º–µ–º —Ö—ç—à –ø–æ–¥—Å—Ç—Ä–æ–∫–∏ —Å `l = 1` –∏ `r = 4`, —Ç–æ –µ—Å—Ç—å "bcd":

getHash(1, 4, abcd) = h[4] - h[1] * p^2 = (a * p^3 + b * p ^ 2 + c * p + d) - a * p^3 = b * p^2 + c * p + d$$

#### 30. –ê–ª–≥–æ—Ä–∏—Ç–º –†–∞–±–∏–Ω–∞-–ö–∞—Ä–ø–∞ –ø–æ–∏—Å–∫ –ø–æ–¥—Å—Ç—Ä–æ–∫–∏ –≤ —Å—Ç—Ä–æ–∫–µ —Å `O(1)` –¥–æ–ø–ø–∞–º—è—Ç–∏.
–£ –Ω–∞—Å –µ—Å—Ç—å —Ç–µ–∫—Å—Ç `t` –≤ –Ω–µ–π –º—ã —Ö–æ—Ç–∏–º –Ω–∞–π—Ç–∏ –ø–æ–¥—Å—Ç—Ä–æ–∫—É `s`. –î–∞–≤–∞–π —Å–¥–µ–ª–∞–µ–º –ø—Ä–µ–¥–ø–æ–¥—Å—á–µ—Ç —Ö–µ—à–∞  —Å—Ç—Ä–æ–∫–∏ `t`, 
–∞ —Ç–∞–∫–∂–µ –∏—Å–∫–æ–º–æ–π –ø–æ–¥—Å—Ç—Ä–æ–∫–∏ `s`. –ó–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏–º —Ü–∏–∫–ª –æ—Ç `0` –¥–æ `n - m` (`n` - –¥–ª–∏–Ω–∞ `t`, `|s| = m`), 
–≥–¥–µ –±—É–¥–µ–º —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å `hash(t[i, i + m])` —Å `hash(s) –∑–∞ `O(1)`. –ï—Å–ª–∏ —Ö–µ—à–∏ –Ω–µ —Å–æ–≤–ø–∞–ª–∏, —Ç–æ —ç—Ç–æ —Ç–æ—á–Ω–æ –Ω–µ –ø–æ–¥—Å—Ç—Ä–æ–∫–∞,
–∞ –µ—Å–ª–∏ —Å–æ–≤–ø–∞–ª–∏, —Ç–æ —ç—Ç–æ –Ω–∞—à –æ—Ç–≤–µ—Ç (_–¥–µ–π—Å—Ç–≤—É–µ–º –ø–æ RP_).

–ú—ã –º–æ–∂–µ–º –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –Ω–∞—à –∞–ª–≥–æ—Ä–∏—Ç–º —Å `O(1)` –¥–æ–ø–ø–∞–º—è—Ç–∏. –î–∞–≤–∞–π—Ç–µ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –ø–æ—Å—á–∏—Ç–∞–µ–º –ø—Ä–µ—Ñ–∏–∫—Å –¥–ª–∏–Ω—ã `m`, —Ç–æ –µ—Å—Ç—å
`ht_0 = hash(t[:m])`, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –±—É–¥–µ–º –∏–∑–º–µ–Ω—è—Ç—å: `ht_{i+1} = (h_i * p - t_i * p^n + t_{i + m})  mod M`.

#### 31. –û–±—â–∏–µ —Å–ª–æ–≤–∞ –ø—Ä–æ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ. RP –∏ ZPP –≤–µ—Ä—Å–∏–∏ –†–∞–±–∏–Ω–∞-–ö–∞—Ä–ø–∞.
–ü–æ—Å—Ç—Ä–æ–∏–º —Ö—ç—à —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã `A` –≤ –º–∞—Å—Å–∏–≤ `[0, m)`: `f: A -> Z / mZ `.
–ù–∞–º —ç—Ç–æ –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω–æ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å –ø–æ–¥—Å—Ç—Ä–æ–∫–∏ –∑–∞ `O(1)`. –ï—Å–ª–∏ —Ö–µ—à–∏ –Ω–µ —Å–æ–≤–ø–∞–ª–∏, —Ç–æ –∏ –ø–æ–¥—Å—Ç—Ä–æ–∫–∏ –Ω–µ —Å–æ–≤–ø–∞–ª–∏.
–ò–Ω–∞—á–µ, –º—ã –º–æ–∂–µ–º –ø–æ–≤–µ—Ä–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã, —Ç–æ –µ—Å—Ç—å –ø–æ–ª—É—á–∏—Ç—å `RP` –∞–ª–≥–æ—Ä–∏—Ç–º. –í –¥—Ä—É–≥–æ–º —Å–ª—É—á–∞–µ –º—ã –º–æ–∂–µ–º –ø—Ä–æ–π—Ç–∏ –∏ —á–µ—Å—Ç–Ω–æ —Å—Ä–∞–≤–Ω–∏—Ç—å 
–¥–≤–µ –ø–æ–¥—Å—Ç—Ä–æ–∫–∏, —Ç–æ –µ—Å—Ç—å –ø–æ–ª—É—á–∏—Ç—å `ZPP` –∞–ª–≥–æ—Ä–∏—Ç–º. –ö–æ–ª–ª–∏–∑–∏—è —Ö–µ—à–µ–π, –∫–æ–≥–¥–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–Ω—ä–µ–∫—Ü–∏—è.

#### 32. –ö–∞–∫–∏–º —Ö–µ—à–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∏ –ø–æ—á–µ–º—É?
–°—É—â–µ—Å—Ç–≤—É–µ—Ç –¥–≤–∞ –≤–∏–¥–∞ –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω–æ–≥–æ —Ö–µ—à–∞: –ø—Ä—è–º–æ–π –∏ –æ–±—Ä–∞—Ç–Ω—ã–π. –ü—Ä—è–º–æ–π –ø–ª–æ—Ö —Ç–µ–º, —á—Ç–æ –∫–æ–≥–¥–∞ –º—ã –±–µ—Ä—ë–º —Ö–µ—à —Å –æ—Ç—Ä–µ–∑–∫–∞ –Ω–∞–º –Ω—É–∂–Ω–æ 
–¥–µ–ª–∏—Ç—å, –∞ —ç—Ç–æ –¥–æ—Ä–æ–≥–∞ –æ–ø–µ—Ä–∞—Ü–∏—è. –í –æ–±—Ä–∞—Ç–Ω–æ–º –∂–µ –º—ã —É–º–Ω–æ–∂–∞–µ–º.

–ö–æ–≥–¥–∞ –º—ã –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º –Ω–∞—à—É —Ñ—É–Ω–∫—Ü–∏—é –Ω–∞ –º–∞—Å—Å–∏–≤ –¥–ª–∏–Ω—ã `m`, —Ç–æ `m` –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø—Ä–æ—Å—Ç—ã–º, —á—Ç–æ–±—ã –±—ã–ª–æ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ,
—Ç–∞–∫ –∫–∞–∫ —É –ø—Ä–æ—Å—Ç–æ–≥–æ —á–∏—Å–ª–∞ –¥–≤–∞ –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã—Ö –¥–µ–ª–∏—Ç–µ–ª—è. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ `m = 16`, —Ç–æ –ø—Ä–∏ —Ö–µ—à–µ 0, 16, 32, .. –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –∫–æ–ª–ª–∏–∑–∏—è.

–ù–∞–º –Ω—É–∂–Ω–æ —Å–ª–µ–¥–∏—Ç—å –∑–∞ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ–º, –ø–æ—ç—Ç–æ–º—É –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `int64`, –≤ –∫—Ä–∞–π–Ω–∏—Ö —Å–ª—É—á–∞—è—Ö `__int128`.

`p` —Å–ª–µ–¥—É–µ—Ç –±—ã—Ç—å —Å–ª—É—á–∞–π–Ω—ã–º —á–∏—Å–ª–æ–º, —Ç–æ–≥–¥–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∫–æ–ª–ª–∏–∑–∏–∏ –ø—Ä–∏ –æ–¥–Ω–æ–º —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Ä–∞–≤–Ω–∞ `1/m`.

#### 33. –ù–∞–∏–±–æ–ª—å—à–∞—è –æ–±—â–∞—è –ø–æ–¥—Å—Ç—Ä–æ–∫–∞ –∑–∞ `O(n log n)`.

...
